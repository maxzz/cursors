var $=Object.defineProperty,T=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var I=(e,t,r)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f=(e,t)=>{for(var r in t||(t={}))F.call(t,r)&&I(e,r,t[r]);if(v)for(var r of v(t))R.call(t,r)&&I(e,r,t[r]);return e},N=(e,t)=>T(e,_(t));var h=(e,t)=>{var r={};for(var n in e)F.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&v)for(var n of v(e))t.indexOf(n)<0&&R.call(e,n)&&(r[n]=e[n]);return r};import{a as d,j as A,r as g,u as p,T as Z,t as q,b as O,c as u,R as H,d as K}from"./vendor.edbd3f55.js";const W=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};W();const y=d(null);function k(e,t,r,n){var o;let s;if(r){let c=typeof r=="function"?r((o=e(n))==null?void 0:o.el):r,m=r&&(c==null?void 0:c.getContext("2d"));s=c&&m&&{el:c,ctx:m}}t(n,s)}const z=d(null),j=d(e=>e(z),(e,t,r)=>(n=>k(e,t,r,n))(z)),E=d(null),P=d(e=>e(E),(e,t,r)=>(n=>k(e,t,r,n))(E)),M=d(!0),S=d(32);function U(...e){return e.filter(Boolean).join(" ")}const a=A.exports.jsx,l=A.exports.jsxs,V=A.exports.Fragment;function X(c){var m=c,{onDropped:e,accept:t,className:r,children:n,activeAtom:s}=m,o=h(m,["onDropped","accept","className","children","activeAtom"]);const w=g.exports.useRef(null),[G,x]=p(s);return l("label",N(f({className:U("inline-block",r),onDragOver:i=>{i.preventDefault(),i.stopPropagation(),!G&&x(!0)},onDrop:i=>{i.preventDefault(),i.stopPropagation(),x(!1),e(i.dataTransfer.files)},onDragEnter:i=>x(!0),onDragLeave:i=>x(!1)},o),{children:[a("input",{type:"file",className:"hidden",accept:t,onChange:()=>{var i,D;return((i=w.current)==null?void 0:i.files)&&e((D=w.current)==null?void 0:D.files)},ref:w}),n]}))}function J(e){const n=e,{title:t}=n,r=h(n,["title"]);return l("svg",N(f({fill:"currentColor",viewBox:"0 0 24 24"},r),{children:[t&&a("title",{children:t}),a("path",{d:"M19 10a1 1 0 0 0-1 1v3.38l-1.48-1.48a2.79 2.79 0 0 0-3.93 0l-.7.71l-2.48-2.49a2.79 2.79 0 0 0-3.93 0L4 12.61V7a1 1 0 0 1 1-1h8a1 1 0 0 0 0-2H5a3 3 0 0 0-3 3v12.22A2.79 2.79 0 0 0 4.78 22h12.44a2.88 2.88 0 0 0 .8-.12a2.74 2.74 0 0 0 2-2.65V11A1 1 0 0 0 19 10zM5 20a1 1 0 0 1-1-1v-3.57l2.89-2.89a.78.78 0 0 1 1.1 0L15.46 20zm13-1a1 1 0 0 1-.18.54L13.3 15l.71-.7a.77.77 0 0 1 1.1 0L18 17.21zm3-15h-1V3a1 1 0 0 0-2 0v1h-1a1 1 0 0 0 0 2h1v1a1 1 0 0 0 2 0V6h1a1 1 0 0 0 0-2z"})]}))}function Q(){return a("div",{className:"toaser",children:a(Z,{position:"bottom-right",reverseOrder:!1,gutter:8,containerClassName:"",containerStyle:{},toastOptions:{className:"",duration:5e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}})})}const C=(e,t)=>q(e,f({style:{backgroundColor:"tomato"}},t));function Y(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(new Error("Failed to load file")),n.readAsDataURL(e)})}function ee(e){return new Promise((t,r)=>{const n=new Image;!e||!n?r():(n.onload=()=>t(n),n.onerror=s=>r(new Error("Failed to create image")),n.src=e.toString())})}function b(e,t){e.ctx.fillStyle="red",e.ctx.fillRect(0,0,e.el.width,e.el.height),e.ctx.drawImage(t,0,0)}function L(e,t){const r=t.match(/([a-fA-F\d]{2})/g);if(!r||r.length!==3)throw new Error("invalid color");const n=e.ctx.getImageData(0,0,e.el.width,e.el.height),s=n.data,o=[s[length-4],s[length-3],s[length-2]];for(var c=0;c<=s.length;c+=4)s[c+1]=+o[1],s[c+2]=s[c+2]^+o[2];e.ctx.putImageData(n,0,0)}function te(){const e=O(y),[t]=g.exports.useState(d(!1)),r=u(t);async function n(s){if(!!s.length)try{const o=await Y(s[0]),c=await ee(o);e(c)}catch(o){e(null),C((o==null?void 0:o.message)||"Failed to load image")}}return l("div",{className:"relative",children:[a("div",{className:`absolute left-4 top-0.5 pb-0.5 text-xs ${r?"text-slate-50 font-bold":"text-slate-100"}`,children:r?"Drop":"Load image"}),a(X,{className:`w-32 h-32 ${r?"bg-green-700":"bg-slate-400"} border-slate-500 border rounded cursor-pointer`,onDropped:n,activeAtom:t,children:a(J,{className:`${r?"text-green-600/30":"text-slate-300"}   pointer-events-none`})})]})}function re(){const e=u(y),t=u(j),r=u(M);return g.exports.useEffect(()=>{if(!!t)try{e?(b(t,e),r&&L(t,"#000000")):t.ctx.clearRect(0,0,t.el.width,t.el.height)}catch(n){C("Failed to render image"),console.log("Failed to render image",n)}},[t,e,r]),g.exports.useEffect(()=>{!t||(r?r&&L(t,"#300000"):e&&b(t,e))},[t,r]),null}function ne(){const e=u(y),t=u(P);return g.exports.useEffect(()=>{if(!!t)try{e?(t.el.width=e.width,t.el.height=e.height,b(t,e)):t.ctx.clearRect(0,0,t.el.width,t.el.height)}catch(r){C("Failed to render image"),console.log("Failed to render image",r)}},[t,e]),null}function ae(){return l(V,{children:[a(re,{}),a(ne,{})]})}function B(r){var n=r,{updateAtom:e}=n,t=h(n,["updateAtom"]);const s=O(e);return a("canvas",f({ref:s},t))}function se(){return l("div",{className:"flex gap-4",children:[a("div",{className:"border-red-700 border",children:a(B,{className:"bg-slate-300",updateAtom:j})}),a("div",{className:"border-red-700 border",children:a(B,{className:"bg-slate-300",updateAtom:P})})]})}const oe=[16,32,64,128,256];function ce(){const[e,t]=p(S);return a("div",{className:"",children:l("label",{className:"h-6 text-sm flex items-center space-x-2",children:[a("div",{className:"",children:"Size"}),a("input",{type:"range",value:e,onChange:r=>t(+r.target.value)}),a("div",{className:"",children:a("input",{className:"w-10 text-center",type:"text",value:e,onChange:r=>t(+r.target.value)})})]})})}function le(){const[e,t]=p(S);function r(n){t(+n.target.value)}return a("div",{className:"self-start flex items-center space-x-2",children:oe.map((n,s)=>l("label",{className:"text-xs flex items-center space-x-1",children:[a("input",{className:"form-radio",type:"radio",value:n,checked:e===n,onChange:r}),a("div",{className:"",children:n})]},n))})}function ie(){return p(S),l("div",{className:"self-start flex flex-col space-y-4",children:[a(le,{}),a(ce,{})]})}function de(r){var n=r,{className:e}=n,t=h(n,["className"]);const[s,o]=p(M);return l("label",N(f({className:U("flex items-center space-x-2 select-none",e)},t),{children:[a("input",{className:"w-4 h-4 text-slate-500 bg-purple-200 focus:ring-slate-500 focus:ring-offset-1 rounded",type:"checkbox",checked:s,onChange:c=>o(c.target.checked)}),a("div",{className:"",children:"show gray"})]}))}function ue(){const e=u(y);return l("div",{className:"h-full flex flex-col",children:[a(ae,{}),l("div",{className:"flex space-x-2",children:[a(te,{}),e&&a(de,{className:"self-end pb-1"}),a(ie,{})]}),a("div",{className:"flex-1 flex items-center justify-center",children:a(se,{})})]})}function fe(){return l(V,{children:[a(Q,{}),a("div",{className:"h-screen bg-purple-200 p-4",children:a(ue,{})})]})}H.render(a(K.StrictMode,{children:a(fe,{})}),document.getElementById("root"));
